Object.extend=function(a,c){for(var b in c){a[b]=c[b]}return a};BeSocial=Object.extend({addQuery:function(e,c,b){var a=[];c=c||"=";b=b||"&";for(var d in e){if(e[d]){a.push(d.toString()+c+encodeURIComponent(e[d]))}}return a.join(b)},addScript:function(b){var a=document.createElement("script");a.charSet="utf-8";a.src=b;(document.getElementsByTagName("HEAD")[0]||document.documentElement).appendChild(a)},addCounter:function(e,c){var a=document.getElementById("besocial-"+e),d=document.createElement("span"),b=document.createElement("span");d.className="besocial-meta";d.appendChild(document.createTextNode("\u00A0"));b.className="besocial-stat";b.appendChild(document.createTextNode(c));a.appendChild(d);a.appendChild(b);a.target="_blank"},facebookAPI:function(){var a=[];a.push(this.url);if(this.twitter_url!==""){a.push(this.twitter_url)}this.addScript("http://api.facebook.com/restserver.php?"+this.addQuery({v:"1.0",method:"fql.query",query:'select total_count from link_stat where url in("'+a.join('","')+'")',format:"json",callback:"BeSocial.facebookResponse"}))},facebookResponse:function(c){var b=0,a=c.length-1;for(;a>=0;a--){b+=parseInt(c[a].total_count,10)}this.addCounter("facebook",b)},tweetmemeAPI:function(){this.addScript("http://api.tweetmeme.com/url_info.jsonc?"+this.addQuery({url:this.url,callback:"BeSocial.tweetmemeResponse"}))},tweetmemeResponse:function(b){var a=0;if(b.status==="success"){a=b.story.url_count||0}this.addCounter("twitter",a)},bitacorasAPI:function(){this.addScript("http://api.bitacoras.com/anotacion/"+this.addQuery({key:this.bitacoras_apikey,url:this.url,format:"json",callback:"BeSocial.bitacorasResponse"},"/","/"))},bitacorasResponse:function(b){var a=b.data.votos||0;this.addCounter("bitacoras",a)},meneameAPI:function(){this.addScript("http://meneame.net/api/url.php?"+this.addQuery({url:this.url,jsonp:"BeSocial.meneameResponse"}))},meneameResponse:function(f){if(f.status==="OK"){var c=document.getElementById("besocial-meneame"),e=c.parentNode,d=0,b=0,a=f.data.length;for(;b<a;b++){if(f.data[b].status==="published"||f.data[b].status==="queued"){c.href=f.data[b].url;this.addCounter("meneame",f.data[b].votes+f.data[b].anonymous);return}}e.parentNode.removeChild(e)}else{this.addCounter("meneame",0)}},init:function(){this.url=window.location.href.replace(/(?:#.*)?$/,"");if(this.twitter_active==="1"){this.tweetmemeAPI()}if(this.facebook_active==="1"){this.facebookAPI()}if(this.bitacoras_active==="1"){this.bitacorasAPI()}if(this.meneame_active==="1"){this.meneameAPI()}}},BeSocial);BeSocial.init();